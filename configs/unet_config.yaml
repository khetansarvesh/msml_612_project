# UNet Configuration for CIFAR-10

# Random seed for full reproducibility (can be overridden by SEED environment variable)
seed: 42

# ============================================================================
# Data configuration
# ============================================================================
data:
  batch_size: 64 # 64 per GPU × 4 GPUs = 256 effective batch size
  shuffle: True
  num_workers: 0 # number of data loading workers (0 = main process)

# ============================================================================
# Model configuration - UNet specific
# ============================================================================
model:
  # Image properties (CIFAR-10: 32×32 RGB)
  image_size: 32
  image_channels: 3
  # UNet architecture parameters
  base_channels: 64
  channel_multipliers: [1, 2, 4, 8]
  num_res_blocks: 2
  # These are not used by UNet but kept for compatibility
  depth: 12
  num_heads: 8
  hidden_dim: 384

# ============================================================================
# Training configuration
# ============================================================================
training:
  num_epochs: 100
  learning_rate: 2.0e-4
  optimizer: "adam"
  adam_betas: [0.9, 0.999]
  adam_eps: 1.0e-8
  weight_decay: 1.0e-4
  # Checkpoint settings
  checkpoint_path: "outputs/unet_outputs/trained_models/"
  save_every_n_epochs: 10
  # Resume from checkpoint (set to None or empty string to skip)
  resume_from: null
  # Spot instance options (for AWS training)
  save_every_epoch: false # Enable to save after every epoch (useful for spot instances, but slower)
  auto_resume: true # Automatically resume from latest checkpoint if available

# ============================================================================
# Diffusion process configuration
# ============================================================================
diffusion:
  # Number of diffusion timesteps
  num_steps: 1000
  # Beta schedule parameters
  beta_start: 1.0e-4
  beta_end: 0.02
  beta_schedule: "linear" # "linear" or "cosine"

# ============================================================================
# Inference/Sampling configuration
# ============================================================================
inference:
  num_samples: 16
  num_grid_rows: 4
  class_label: 1 # class to generate (0-9 for CIFAR-10: 0=airplane, 1=automobile, 2=bird, 3=cat, 4=deer, 5=dog, 6=frog, 7=horse, 8=ship, 9=truck)
  seed: null # if provided, uses this seed for deterministic sampling
  save_path: "outputs/unet_outputs/sample_grid.png"

# ============================================================================
# Device and debugging
# ============================================================================
device: "cuda" # "cuda" or "cpu"
deterministic_algorithms: True # enforce deterministic PyTorch algorithms
